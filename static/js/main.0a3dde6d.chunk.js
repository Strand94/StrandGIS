(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{156:function(e,t,n){},158:function(e,t,n){},160:function(e){e.exports={}},161:function(e,t,n){},163:function(e,t,n){},167:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(4),r=n.n(i),l=(n(55),n(84),n(5)),c=n(6),s=n(9),u=n(7),d=n(8),m=n(2),f=n(15),y=n.n(f),p=(n(86),n(88),n(3)),h=n.n(p),v={};function g(e,t){var n=e,a=t;this.setState({geojson:n,geojson_key:a})}function b(e){var t;console.log(e);var n=document.getElementsByTagName("g");for(t=e.length;t>-1;t--){var a=document.getElementsByClassName(e[t]+" leaflet-interactive");console.log(e[t]),h()(a).appendTo(n)}}v.params={center:[63.43,10.4],zoomControl:!1,zoom:12,scrollwheel:!1,legends:!0,infoControl:!1,attributionControl:!0},v.tileLayer={uri:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",params:{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',id:"",accessToken:"",noWrap:!0,maxZoom:18,minZoom:4}};var E=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={map:null,tileLayer:null,geojsonLayer:null,geojson:null,geojson_key:null},n._mapNode=null,n.onEachFeature=n.onEachFeature.bind(Object(m.a)(Object(m.a)(n))),g=g.bind(Object(m.a)(Object(m.a)(n))),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.state.map||this.init(this._mapNode)}},{key:"componentDidUpdate",value:function(e,t){this.state.geojson!==t.geojson&&this.addGeoJSONLayer(this.state.geojson,this.state.geojson_key)}},{key:"componentWillUnmount",value:function(){this.state.map.remove()}},{key:"addGeoJSONLayer",value:function(e,t){var n=y.a.geoJson(e,{onEachFeature:this.onEachFeature});null!==this.state.geojson_key?n.setStyle({className:"map-path "+this.state.geojson_key}):n.setStyle({className:"map-path"}),n.addTo(this.state.map),this.state.map.fitBounds(n.getBounds()),this.setState({geojsonLayer:n})}},{key:"zoomToFeature",value:function(e){}},{key:"onEachFeature",value:function(e,t){if(e.properties&&e.properties.NAME){var n="<h3>".concat(e.properties.NAME,"</h3>");t.bindPopup(n)}}},{key:"init",value:function(e){if(!this.state.map){var t=y.a.map(e,v.params);y.a.control.zoom({position:"bottomleft"}).addTo(t),y.a.control.scale({position:"bottomleft"}).addTo(t);var n=y.a.tileLayer(v.tileLayer.uri,v.tileLayer.params).addTo(t);this.setState({map:t,tileLayer:n})}}},{key:"render",value:function(){var e=this;this.state.lat,this.state.lng;return o.a.createElement("div",{id:"mapUI"},o.a.createElement("div",{ref:function(t){return e._mapNode=t},id:"map"}))}}]),t}(a.Component),_=n(27),j=n(71),O=n.n(j);n(90),n(92);function k(e){this.setState({layer_list:e})}var N=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={layer_list:[]},k=k.bind(Object(m.a)(Object(m.a)(n))),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){for(var e=this,t=this.state.layer_list,n=[],a=0;a<t.length;a++)n.push({name:t[a][0],key:t[a][1]});var i=n.map(function(e){return o.a.createElement("option",{className:e.key,value:e.key},e.name.slice(0,30))});return o.a.createElement("div",null,o.a.createElement("p",null,"Select the 2 layers you want to unite."),o.a.createElement("select",{id:"union_select_geojson1"},i),o.a.createElement("select",{id:"union_select_geojson2"},i),o.a.createElement("button",{onClick:function(t){return e.executeUnion(t)}},"Apply"))}},{key:"executeUnion",value:function(){var e=document.getElementById("union_select_geojson1"),t=e.options[e.selectedIndex].value,n=document.getElementById("union_select_geojson2");$(t,n.options[n.selectedIndex].value)}}]),t}(a.Component);n(94);function C(e){this.setState({layer_list:e})}var w=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={layer_list:[]},C=C.bind(Object(m.a)(Object(m.a)(n))),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){for(var e=this,t=this.state.layer_list,n=[],a=0;a<t.length;a++)n.push({name:t[a][0],key:t[a][1]});var i=n.map(function(e){return o.a.createElement("option",{className:e.key,value:e.key},e.name.slice(0,30))});return o.a.createElement("div",null,o.a.createElement("p",null,"Select the 2 layers you want to intersect."),o.a.createElement("select",{id:"intersect_select_geojson1"},i),o.a.createElement("select",{id:"intersect_select_geojson2"},i),o.a.createElement("button",{onClick:function(t){return e.executeIntersect(t)}},"Apply"))}},{key:"executeIntersect",value:function(){var e=document.getElementById("intersect_select_geojson1"),t=e.options[e.selectedIndex].value,n=document.getElementById("intersect_select_geojson2");q(t,n.options[n.selectedIndex].value)}}]),t}(a.Component);n(96);function S(e){this.setState({layer_list:e})}var F=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={layer_list:[]},S=S.bind(Object(m.a)(Object(m.a)(n))),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){for(var e=this,t=this.state.layer_list,n=[],a=0;a<t.length;a++)n.push({name:t[a][0],key:t[a][1]});var i=n.map(function(e){return o.a.createElement("option",{className:e.key,value:e.key},e.name.slice(0,30))});return o.a.createElement("div",null,o.a.createElement("p",null,"Select the 2 layers you want to difference."),o.a.createElement("select",{id:"difference_select_geojson1"},i),o.a.createElement("select",{id:"difference_select_geojson2"},i),o.a.createElement("button",{onClick:function(t){return e.executeDifference(t)}},"Apply"))}},{key:"executeDifference",value:function(){var e=document.getElementById("difference_select_geojson1"),t=e.options[e.selectedIndex].value,n=document.getElementById("difference_select_geojson2");H(t,n.options[n.selectedIndex].value)}}]),t}(a.Component),x=n(72),B=n.n(x),I=n(53),L=n.n(I),P=(n(154),n(51));function J(e){console.log("called: "+e);var t=h()("#change_name_"+e).val();if(console.log(t),void 0==t)console.log("Sdkipping changeName");else{for(var n=0;n<this.state.layer_list.length;n++)if(e==this.state.layer_list[n][1])var a=n;var o=Object(_.a)(this.state.layer_list);o[a][0]=t,this.setState({layers:o})}}function D(e){var t=document.getElementsByClassName("map-path "+this.className);console.log(t),h()(t).css("fill",e.color),h()(t).css("fill-opacity",e.alpha/100)}function M(e){var t=document.getElementsByClassName("map-path "+this.className);console.log(t),h()(t).css("stroke",e.color),h()(t).css("stroke-opacity",e.alpha/100)}function G(e){for(var t=h()("li.active").attr("id"),n=0;n<this.state.layer_list.length;n++)if(t==this.state.layer_list[n][1])var a=n;var o=this.state.layer_list[a][2],i=(i=this.state.layer_list[a][0].split(" ").join("_")).replace(".geojson",""),r=new Blob([JSON.stringify(o)],{type:"geojson;charset=utf-8"});B.a.saveAs(r,i+".geojson")}function T(e,t,n){this.setState({layer_list:Object(_.a)(this.state.layer_list).concat([[e,t,n]])})}function z(){for(var e=document.getElementById("sortable_layers"),t=e.getElementsByClassName("layer"),n=0;n<t.length;n++)t[n].addEventListener("click",function(){var e=document.getElementsByClassName("active");e[0]&&(e[0].className=e[0].className.replace(" active","")),this.className+=" active"});function a(){var e,t=[],n=document.getElementsByClassName("layer");for(e=0;e<n.length;e++){var a=n[e].className.split(" ");t.push(a[1])}return t}b(a()),O.a.create(e,{onEnd:function(e){b(a())}})}var A=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={layer_list:[],name_list:[]},n.readGeoJSONFile=n.readGeoJSONFile.bind(Object(m.a)(Object(m.a)(n))),G=G.bind(Object(m.a)(Object(m.a)(n))),T=T.bind(Object(m.a)(Object(m.a)(n))),J=J.bind(Object(m.a)(Object(m.a)(n))),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e,t){if(this.state.layer_list!==t.layer_list){ae(this.state.layer_list),k(this.state.layer_list),C(this.state.layer_list),S(this.state.layer_list);var n=this.state.layer_list[this.state.layer_list.length-1][1],a=document.getElementById("checkbox_"+n),o=document.getElementById("customize_"+n);a.addEventListener("click",function(e){e.stopPropagation();var t=document.getElementById("checkbox_"+n),a=document.getElementsByClassName("map-path "+n);1==t.checked?h()(a).show():h()(a).hide()}),o.addEventListener("click",function(e){e.stopPropagation();document.getElementById("customize_"+n);var t="customizeDiv_"+n,a=h()("."+t).is(":visible"),o=document.getElementsByClassName("layer "+n);a?(h()("."+t).hide(),h()(o).css("height","65px")):(h()("."+t).show(),h()(o).css("height","200px"))})}z()}},{key:"componentDidMount",value:function(){z()}},{key:"render",value:function(){for(var e=this,t=this.state.layer_list,n=[],a=0;a<t.length;a++)n.push({name:t[a][0],key:t[a][1]});var i=n.map(function(e){return o.a.createElement("li",{className:"layer "+e.key,id:e.key},o.a.createElement("div",{className:"LayerContainer"},o.a.createElement("div",{className:"LayerData"},o.a.createElement("p",{className:"LayerName dont-break-out",id:"name_"+e.key},e.name.slice(0,30)),o.a.createElement("input",{className:"toggleShow",type:"checkbox",defaultChecked:!0,id:"checkbox_"+e.key}),o.a.createElement("input",{className:"customize",type:"button",value:"\u2699\ufe0f",id:"customize_"+e.key})),o.a.createElement("div",{className:"customizeDiv_"+e.key,hidden:!0},o.a.createElement("div",null,o.a.createElement("p",{id:"edit_text"},"Change name:"),o.a.createElement("input",{type:"text",value:e.name,onChange:function(t){return J(e.key)},id:"change_name_"+e.key}),o.a.createElement("p",{id:"edit_text"},"Change colors:"),o.a.createElement("div",{id:"container"},o.a.createElement("div",{id:"fill"},o.a.createElement("p",null,"Fill"),o.a.createElement(L.a,{className:e.key,color:"#0ad",onChange:D,alpha:50})),o.a.createElement("div",{id:"stroke"},o.a.createElement("p",null,"Stroke"),o.a.createElement(L.a,{className:e.key,color:"#0ad",onChange:M,alpha:50})))))))});return o.a.createElement("div",{id:"layers"},o.a.createElement("p",{id:"subtitle"},"Layers"),o.a.createElement("button",{id:"delete",onClick:function(t){return e.deleteLayer(t)}},"\ud83d\uddd1\ufe0f"),o.a.createElement("button",{id:"save",onClick:function(e){return G(e)}},"\ud83d\udcbe"),o.a.createElement("p",{id:"sub_info"},"Click to select, drag to reorder."),o.a.createElement("div",null,o.a.createElement("ul",{id:"sortable_layers",className:"ui-sortable"},i)),o.a.createElement("div",null,o.a.createElement("p",{id:"subtitle"},"Add Layer"),o.a.createElement("div",null,o.a.createElement("input",{id:"fileid",type:"file",onChange:function(t){return e.readGeoJSONFile(t)},accept:".GeoJSON,.JSON",hidden:!0}),o.a.createElement("button",{id:"upload",onClick:function(t){return e.activateFileUpload(t)}},"Upload file")),o.a.createElement("p",{id:"sub_info"},"Click button and upload GeoJSON or JSON file.")))}},{key:"activateFileUpload",value:function(){document.getElementById("fileid").click()}},{key:"deleteLayer",value:function(){X(h()("li.active").attr("id"))}},{key:"readGeoJSONFile",value:function(e){var t=e.target.files[0],n=Math.random().toString(36).substr(2,9),a=t.name;if(t){var o=new FileReader;o.onload=function(e){var t=JSON.parse(e.target.result);if("FeatureCollection"==t.type){for(var o=t.features,i=[],r=0;r<o.length;r++)if("Polygon"==o[r].geometry.type)i.push(o[r]);else if("MultiPolygon"==o[r].geometry.type)for(var l=0;l<o[r].geometry.coordinates.length;l++){var c={type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:o[r].geometry.coordinates[l]}};i.push(c)}else if("Point"==o[r].geometry.type){var s=P.circle(o[r].geometry.coordinates,.0025);i.push(s)}else"LineString"==o[r].geometry.type&&i.push(o[r]);var u={type:"FeatureCollection",features:i}}else if("Feature"==t.type)u={type:"FeatureCollection",features:t};else u=function(e){if("Polygon"==e.type){var t={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:e.coordinates}}]};return t}if("MultiPolygon"==e.type)return V(e);if("Point"==e.type){var n=P.circle(e.coordinates,2),t={type:"FeatureCollection",features:n};return t}}(t);ne(u,n),T(a,n,u)},o.readAsText(t)}else alert("Failed to load file")}}]),t}(a.Component),U=(n(156),n(158),n(160),n(165),n(51),function(e){function t(e){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).call(this,e))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement("div",{id:"tool_title"},"Distance:"),o.a.createElement("input",{id:"buffer_number",type:"number",placeholder:"Buffer in meters"}),o.a.createElement("br",null),o.a.createElement("button",{onClick:function(t){return e.executeBuffer(t)}},"Apply"))}},{key:"executeBuffer",value:function(){Z(document.getElementById("buffer_number").value,h()("li.active").attr("id"))}}]),t}(a.Component)),W=(n(161),function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement("button",{onClick:function(t){return e.executeDissolve(t)}},"Apply"))}},{key:"executeDissolve",value:function(){Q(h()("li.active").attr("id"))}}]),t}(a.Component)),R=n(51);function Z(e,t){for(var n=Y(t),a=ee(n),o=this.state.layer_list[n][0],i=R.buffer(a,e,{units:"meters"}),r=i.features[0],l=1;l<i.features.length;l++)r=R.union(r,i.features[l]);if("MultiPolygon"==r.geometry.type)c=V({type:"FeatureCollection",features:[r]});else var c={type:"FeatureCollection",features:[r]};var s=te();g(c,s),T(o+" "+e+" m buffer",s,c)}function Q(e){for(var t=Y(e),n=ee(t),a=this.state.layer_list[t][0],o=n.features[0],i=1;i<n.features.length;i++)o=R.union(o,n.features[i]);if("MultiPolygon"==o.geometry.type)r=V({type:"FeatureCollection",features:[o]});else var r={type:"FeatureCollection",features:[o]};var l=te();g(r,l),T(a+" dissolved",l,r)}function $(e,t){var n=Y(e),a=ee(n),o=this.state.layer_list[n][0],i=Y(t),r=ee(i),l=this.state.layer_list[i][0],c={type:"FeatureCollection",features:Object(_.a)(a.features).concat(Object(_.a)(r.features))},s=te();g(c,s),T("union "+o+" & "+l,s,c)}function q(e,t){for(var n=Y(e),a=ee(n),o=this.state.layer_list[n][0],i=Y(t),r=ee(i),l=this.state.layer_list[i][0],c=a.features,s=r.features,u=[],d=0;d<c.length;d++)for(var m=c[d],f=0;f<s.length;f++){var p=s[f],h=R.intersect(m,p);null!=h&&u.push(h)}new y.a.LayerGroup;var v={type:"FeatureCollection",features:u},b=te();g(v,b),T("intersect "+o+" & "+l,b,v)}function H(e,t){var n=Y(e),a=ee(n),o=this.state.layer_list[n][0],i=Y(t),r=ee(i),l=this.state.layer_list[i][0];console.log("geo1"),console.log(a),console.log("geo2"),console.log(r);var c=K(a),s=K(r),u=R.difference(c.features[0],s.features[0]);if(null==u)u=null;else var d=V({type:"FeatureCollection",features:[u]});var m=te();g(d,m),T(o+" - "+l,m,d)}function K(e){for(var t=e.features,n=[],a=0;a<t.length;a++)if("Polygon"==t[a].geometry.type)n.push(t[a].geometry.coordinates);else if("LineString"==t[a].geometry.type){var o=R.buffer(t[a].geometry,.5);n.push(o.geometry.coordinates)}else if("MultiPolygon"==t[a].geometry.type)n.push(t[a].geometry.coordinates);else if("Point"==t[a].geometry.type){o=R.buffer(t[a].geometry,.5);n.push(o.geometry.coordinates)}return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"MultiPolygon",coordinates:n}}]}}function V(e){for(var t=e.features,n=[],a=0;a<t.length;a++)if("Polygon"==t[a].geometry.type)n.push(t[a]);else if("MultiPolygon"==t[a].geometry.type)for(var o=0;o<t[a].geometry.coordinates.length;o++){var i={type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:t[a].geometry.coordinates[o]}};n.push(i)}return{type:"FeatureCollection",features:n}}function X(e){var t=Y(e);this.state.layer_list[t][2];h()("#"+e).remove(),h()("#layer_"+e).remove(),h()("."+e).remove()}function Y(e){for(var t=0;t<this.state.layer_list.length;t++)if(e==this.state.layer_list[t][1])return t}function ee(e){return this.state.layer_list[e][2]}function te(){return Math.random().toString(36).substr(2,9)}function ne(e,t){g(e,t)}function ae(e){this.setState({layer_list:e})}var oe=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={layer_list:[]},Z=Z.bind(Object(m.a)(Object(m.a)(n))),Q=Q.bind(Object(m.a)(Object(m.a)(n))),$=$.bind(Object(m.a)(Object(m.a)(n))),q=q.bind(Object(m.a)(Object(m.a)(n))),H=H.bind(Object(m.a)(Object(m.a)(n))),ne=ne.bind(Object(m.a)(Object(m.a)(n))),ae=ae.bind(Object(m.a)(Object(m.a)(n))),Y=Y.bind(Object(m.a)(Object(m.a)(n))),X=X.bind(Object(m.a)(Object(m.a)(n))),ee=ee.bind(Object(m.a)(Object(m.a)(n))),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return[o.a.createElement("div",{id:"sidebar_content"},o.a.createElement("div",{id:"sidebar_title_div"},o.a.createElement("a",{href:"http://www.anstra.no/",target:"_blank",id:"title"},"StrandGIS")),o.a.createElement("div",{id:"tools"},o.a.createElement("p",{id:"subtitle"},"Tools"),o.a.createElement("ul",{id:"tool_layer"},o.a.createElement("li",{className:"buffer"},"Buffer ",this.state.buffer_radius),o.a.createElement("li",{hidden:!0,className:"buffer_content"},o.a.createElement(U,null)),o.a.createElement("li",{className:"dissolve"},"Dissolve"),o.a.createElement("li",{hidden:!0,className:"dissolve_content"},o.a.createElement(W,null)),o.a.createElement("li",{className:"union"},"Union"),o.a.createElement("li",{hidden:!0,className:"union_content"},o.a.createElement(N,null)),o.a.createElement("li",{className:"intersect"},"Intersect"),o.a.createElement("li",{hidden:!0,className:"intersect_content"},o.a.createElement(w,null)),o.a.createElement("li",{className:"difference"},"Difference"),o.a.createElement("li",{hidden:!0,className:"difference_content"},o.a.createElement(F,null)),o.a.createElement("li",{className:"extract"},"Extract Feature"),o.a.createElement("li",{hidden:!0,className:"extract_content"}))),o.a.createElement("div",{id:"Layers"},o.a.createElement(A,null)))]}}]),t}(a.Component),ie=(n(163),function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return[o.a.createElement("div",{id:"page_content"},o.a.createElement(E,{key:"mainmap_key"}),o.a.createElement("div",{id:"sidebar"},o.a.createElement(oe,{key:"sidebar_key"})))]}}]),t}(a.Component)),re=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function le(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}r.a.render(o.a.createElement(ie,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/StrandGIS",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/StrandGIS","/service-worker.js");re?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):le(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):le(e)})}}(),h()(".buffer").click(function(){h()(".buffer_content").toggle()}),h()(".dissolve").click(function(){h()(".dissolve_content").toggle()}),h()(".intersection").click(function(){console.log("Intersect")}),h()(".union").click(function(){h()(".union_content").toggle()}),h()(".intersect").click(function(){h()(".intersect_content").toggle()}),h()(".difference").click(function(){h()(".difference_content").toggle()})},78:function(e,t,n){e.exports=n(167)},84:function(e,t,n){},88:function(e,t,n){},90:function(e,t,n){},92:function(e,t,n){},94:function(e,t,n){},96:function(e,t,n){}},[[78,2,1]]]);
//# sourceMappingURL=main.0a3dde6d.chunk.js.map