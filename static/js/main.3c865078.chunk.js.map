{"version":3,"sources":["Map/MainMap.js","sidebar/tools/Union.js","sidebar/tools/Intersect.js","sidebar/tools/Difference.js","sidebar/Layers.js","sidebar/tools/Buffer.js","sidebar/tools/Dissolve.js","sidebar/tools/Extract_Feature.js","sidebar/ExtractFeatureWindow.js","sidebar/Sidebar.js","App.js","registerServiceWorker.js","index.js"],"names":["config","get_newgeojson","new_geojson","new_geojson_key","geojson","geojson_key","this","setState","reorderLayers","layers","i","g","document","getElementsByTagName","length","map_layer","getElementsByClassName","$","appendTo","params","center","zoomControl","zoom","scrollwheel","legends","infoControl","attributionControl","tileLayer","uri","attribution","id","accessToken","noWrap","maxZoom","minZoom","MainMap","props","_this","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","state","map","geojsonLayer","_mapNode","onEachFeature","bind","assertThisInitialized","init","prevProps","prevState","addGeoJSONLayer","remove","key","L","geoJson","setStyle","className","addTo","fitBounds","getBounds","target","feature","layer","properties","NAME","popupContent","concat","bindPopup","control","position","scale","_this2","lat","lng","react_default","a","createElement","ref","node","Component","getLayerListUnion","layer_list","Union","layer_data_list","data","push","name","listItems","d","value","slice","onClick","param","executeUnion","union_select1","getElementById","geojson1","options","selectedIndex","union_select2","callUnion","getLayerListIntersect","Intersect","executeIntersect","intersect_select1","intersect_select2","callIntersect","getLayerListDifference","Difference","executeDifference","difference_select1","difference_select2","callDifference","turf","require","changeName","input_element","val","undefined","toConsumableArray","customizeFill","colors","map_element","css","color","alpha","customizeStroke","download","download_layer_key","attr","layer_position","geojson_file","filename","split","join","replace","blob","Blob","JSON","stringify","type","FileSaver","saveAs","createLayer","newest_file_name","newest_file_key","updateSelected","selected_key","geojson_file_name","selected_layer","addLayerProperties","addEventListener","current","getLayers","list_order","class_name","Sortable","create","onEnd","e","Layers","readGeoJSONFile","disableInvalidButtons","getLayerList","hide_map_element","edit_layer_element","event","stopPropagation","checked","show","hide","hide_status","is","list_element","defaultChecked","hidden","onChange","lib_default","deleteLayer","accept","activateFileUpload","prop","click","deleteLayerCall","file_upload","file","files","Math","random","toString","substr","reader","FileReader","onload","parse","result","geojson_features","features","new_features","geometry","j","coordinates","circle","clean_geojson","geojsonMultiPolygonToPolygon","clean_data","new_geojsonToParent","readAsText","alert","Buffer","placeholder","executeBuffer","callBuffer","Dissolve","executeDissolve","callDissolve","Extract_Feature","executeExtract","layer_key","extract_options","getProperties","getPropertiesList","properties_list","layerName","ExtractFeatureWindow","rules","collectAddData","append","toggleAddRulePanel","closeWindow","rule","console","log","buffer_radius","geojson_file_key","find_called_geojson","selected_layer_geojson","collect_called_geojson","selected_layer_name","buffered","buffer","units","buffer_dissolved","union","final_buffer","buffer_layer_key","generateKey","dissolveLayer","final_dissolve","dissolve_layer_key","geojson_file_key1","geojson_file_key2","layer_position1","selected_layer_geojson1","selected_layer_name1","layer_position2","selected_layer_geojson2","selected_layer_name2","unionLayer","union_layer_key","f1","f2","conflictlist","parcel1","parcel2","conflict","intersect","LayerGroup","intersectLayer","intersect_layer_key","difference1","geojsonPolygonToMultiPolygon","difference2","difference","differenceLayer","difference_layer_key","valuearray","property","hasOwnProperty","indexOf","property_data","geojson_file_position","Sidebar","href","sidebar_tools_Buffer","sidebar_tools_Dissolve","sidebar_tools_Union","sidebar_tools_Intersect","sidebar_tools_Difference","sidebar_tools_Extract_Feature","src_sidebar_Layers","App","src_sidebar_ExtractFeatureWindow","src_Map_MainMap","src_sidebar_Sidebar","isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","catch","error","ReactDOM","render","src_App_0","URL","process","origin","fetch","response","status","headers","get","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker","toggle"],"mappings":"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","file":"static/js/main.3c865078.chunk.js","sourcesContent":["import React, { Component } from 'react';\r\nimport L from 'leaflet';\r\nimport 'leaflet/dist/leaflet.css';\r\nimport 'leaflet-draw/dist/leaflet.draw.css';\r\nimport {Map, TileLayer, Popup, GeoJSON, FeatureGroup, Circle} from 'react-leaflet';\r\nimport './MainMap.css';\r\nimport $ from \"jquery\";\r\n// store the map configuration properties in an object,\r\n// we could also move this to a separate file & import it if desired.\r\nlet config = {};\r\nconfig.params = {\r\n  center: [63.43,10.4],\r\n  zoomControl: false,\r\n  zoom: 12,\r\n  scrollwheel: false,\r\n  legends: true,\r\n  infoControl: false,\r\n  attributionControl: true\r\n};\r\nconfig.tileLayer = {\r\n  uri: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\r\n  params: {\r\n    attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>',\r\n    id: '',\r\n    accessToken: '',\r\n    noWrap: true,\r\n    maxZoom: 18,\r\n    minZoom: 4,\r\n  }\r\n};\r\n\r\n// Gets call from Sidebar to add geojson file to the map.\r\nexport function get_newgeojson(new_geojson, new_geojson_key) {\r\n  var geojson = new_geojson\r\n  var geojson_key = new_geojson_key\r\n  this.setState({ geojson, geojson_key })\r\n}\r\n\r\nclass MainMap extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      map: null,\r\n      tileLayer: null,\r\n      geojsonLayer: null,\r\n      geojson: null,\r\n      geojson_key: null,\r\n    };\r\n    this._mapNode = null;\r\n    this.onEachFeature = this.onEachFeature.bind(this);\r\n    get_newgeojson = get_newgeojson.bind(this)\r\n  }\r\n\r\n  // code to run just after the component \"mounts\" / DOM elements are created\r\n  componentDidMount() {\r\n    // creates the Leaflet map object\r\n    if (!this.state.map) this.init(this._mapNode);\r\n  }\r\n\r\n  // code to run when the component receives prop or state updates.\r\n  componentDidUpdate(prevProps, prevState) {\r\n    // Render map again if new geojson data is added.\r\n    if (this.state.geojson !== prevState.geojson){\r\n      this.addGeoJSONLayer(this.state.geojson, this.state.geojson_key);\r\n    }\r\n  }\r\n  // code to run just before unmounting the component\r\n  componentWillUnmount() {\r\n    // this destroys the Leaflet map object & related event listeners\r\n    this.state.map.remove();\r\n  }\r\n\r\n\r\n\r\n// Adds geojson layer to map, while giving it required features and class name\r\n  addGeoJSONLayer(geojson, key) {\r\n    const geojsonLayer = L.geoJson(geojson, {\r\n      onEachFeature: this.onEachFeature,\r\n    });\r\n\r\n    // add our GeoJSON layer to the Leaflet map object\r\n    if (this.state.geojson_key !== null) {\r\n      geojsonLayer.setStyle({'className': 'map-path '+this.state.geojson_key}); //will add key id to geojson layer.\r\n    } else {\r\n      geojsonLayer.setStyle({'className': 'map-path'}); //will add the required class\r\n    }\r\n    geojsonLayer.addTo(this.state.map);\r\n    this.state.map.fitBounds(geojsonLayer.getBounds())\r\n\r\n    // store the Leaflet GeoJSON layer in our component state.\r\n    this.setState({ geojsonLayer });\r\n   }\r\n\r\n  zoomToFeature(target) {\r\n    var fitBoundsParams = {\r\n      paddingTopLeft: [200,10],\r\n      paddingBottomRight: [10,10]\r\n    };\r\n  }\r\n\r\n  onEachFeature(feature, layer) {\r\n    if (feature.properties && feature.properties.NAME) {\r\n\r\n      // assemble the HTML for the markers' popups (Leaflet's bindPopup method doesn't accept React JSX)\r\n      const popupContent = `<h3>${feature.properties.NAME}</h3>`\r\n\r\n      // add our popups\r\n      layer.bindPopup(popupContent);\r\n\r\n    }\r\n\r\n\r\n}\r\n\r\n  // Initializs the map\r\n  init(id) {\r\n    if (this.state.map) return;\r\n    // this function creates the Leaflet map object and is called after the Map component mounts\r\n    let map = L.map(id, config.params);\r\n    L.control.zoom({ position: \"bottomleft\"}).addTo(map);\r\n    L.control.scale({ position: \"bottomleft\"}).addTo(map);\r\n\r\n    // a TileLayer is used as the \"basemap\"\r\n    const tileLayer = L.tileLayer(config.tileLayer.uri, config.tileLayer.params).addTo(map);\r\n\r\n    // set our state to include the tile layer\r\n    this.setState({ map, tileLayer });\r\n  }\r\n\r\n  render() {\r\n    //Set the map position and zoom level\r\n    const position = [this.state.lat, this.state.lng]\r\n\r\n    return (\r\n      <div id=\"mapUI\">\r\n         <div ref={(node) => this._mapNode = node} id=\"map\" />\r\n     </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport function reorderLayers(layers) {\r\n  var i;\r\n  var g = document.getElementsByTagName(\"g\");\r\n  for (i=layers.length; i > -1; i--){\r\n    var map_layer = document.getElementsByClassName(layers[i]+\" leaflet-interactive\")\r\n    $(map_layer).appendTo(g);\r\n  }\r\n}\r\n\r\n\r\n\r\nexport default MainMap;\r\n","import React, { Component } from 'react';\r\nimport \"./Union.css\"\r\nimport { callUnion } from '../Sidebar.js'\r\nimport $ from \"jquery\";\r\n\r\n\r\n// Fetches layer_list from layers, in order to get selection data.\r\nexport function getLayerListUnion(layer_list) {\r\n  this.setState({ layer_list })\r\n}\r\n\r\nclass Union extends Component{\r\n  constructor(props){\r\n    super(props)\r\n    this.state = {\r\n      layer_list: []\r\n    }\r\n    getLayerListUnion = getLayerListUnion.bind(this);\r\n  }\r\n\r\n  render(){\r\n    // Parses through all layers stored in memory and add them to the select lists.\r\n    const layer_data_list = this.state.layer_list\r\n    var data = []\r\n    for (var i = 0; i < layer_data_list.length; i++) {\r\n      data.push({\"name\":layer_data_list[i][0],\"key\":layer_data_list[i][1]})\r\n    }\r\n    const listItems = data.map((d) => <option className={d.key} value={d.key}>{d.name.slice(0,30)}</option>)\r\n\r\n    return(\r\n      <div>\r\n        <p>Select the 2 layers you want to unite.</p>\r\n        <select id=\"union_select_geojson1\">\r\n          {listItems}\r\n        </select>\r\n        <select id=\"union_select_geojson2\">\r\n          {listItems}\r\n        </select>\r\n        <button onClick={(param) => this.executeUnion(param)}>Apply</button>\r\n      </div>\r\n    )\r\n}\r\n\r\n    // Sends call to Sidebar to run Union code.\r\n    executeUnion(){\r\n      // Collects chosen layers from select list.\r\n      var union_select1 = document.getElementById(\"union_select_geojson1\");\r\n      var geojson1 = union_select1.options[union_select1.selectedIndex].value;\r\n      var union_select2 = document.getElementById(\"union_select_geojson2\");\r\n      var geojson2 = union_select2.options[union_select2.selectedIndex].value;\r\n      callUnion(geojson1, geojson2)\r\n    }\r\n\r\n\r\n}\r\n\r\nexport default Union;\r\n","import React, { Component } from 'react';\r\nimport \"./Intersect.css\"\r\nimport { callIntersect } from '../Sidebar.js'\r\nimport $ from \"jquery\";\r\n\r\n\r\n// Fetches layer_list from layers, in order to get selection data.\r\nexport function getLayerListIntersect(layer_list) {\r\n  this.setState({ layer_list })\r\n}\r\n\r\nclass Intersect extends Component{\r\n  constructor(props){\r\n    super(props)\r\n    this.state = {\r\n      layer_list: []\r\n    }\r\n    getLayerListIntersect = getLayerListIntersect.bind(this);\r\n  }\r\n\r\n  render(){\r\n    // Parses through all layers stored in memory and add them to the select lists.\r\n    const layer_data_list = this.state.layer_list\r\n    var data = []\r\n    for (var i = 0; i < layer_data_list.length; i++) {\r\n      data.push({\"name\":layer_data_list[i][0],\"key\":layer_data_list[i][1]})\r\n    }\r\n    const listItems = data.map((d) => <option className={d.key} value={d.key}>{d.name.slice(0,30)}</option>)\r\n\r\n    return(\r\n      <div>\r\n        <p>Select the 2 layers you want to intersect.</p>\r\n        <select id=\"intersect_select_geojson1\">\r\n          {listItems}\r\n        </select>\r\n        <select id=\"intersect_select_geojson2\">\r\n          {listItems}\r\n        </select>\r\n        <button onClick={(param) => this.executeIntersect(param)}>Apply</button>\r\n      </div>\r\n    )\r\n}\r\n\r\n    // Sends call to Sidebar to run Intersect.\r\n    executeIntersect(){\r\n      // Collects chosen layers from select list.\r\n      var intersect_select1 = document.getElementById(\"intersect_select_geojson1\");\r\n      var geojson1 = intersect_select1.options[intersect_select1.selectedIndex].value;\r\n      var intersect_select2 = document.getElementById(\"intersect_select_geojson2\");\r\n      var geojson2 = intersect_select2.options[intersect_select2.selectedIndex].value;\r\n      callIntersect(geojson1, geojson2)\r\n    }\r\n\r\n\r\n}\r\n\r\nexport default Intersect;\r\n","import React, { Component } from 'react';\r\nimport \"./Difference.css\"\r\nimport { callDifference } from '../Sidebar.js'\r\nimport $ from \"jquery\";\r\n\r\n\r\n// Fetches layer_list from layers, in order to get selection data.\r\nexport function getLayerListDifference(layer_list) {\r\n  this.setState({ layer_list })\r\n}\r\n\r\nclass Difference extends Component{\r\n  constructor(props){\r\n    super(props)\r\n    this.state = {\r\n      layer_list: []\r\n    }\r\n    getLayerListDifference = getLayerListDifference.bind(this);\r\n  }\r\n\r\n  render(){\r\n    // Parses through all layers stored in memory and add them to the select lists.\r\n    const layer_data_list = this.state.layer_list\r\n    var data = []\r\n    for (var i = 0; i < layer_data_list.length; i++) {\r\n      data.push({\"name\":layer_data_list[i][0],\"key\":layer_data_list[i][1]})\r\n    }\r\n    const listItems = data.map((d) => <option className={d.key} value={d.key}>{d.name.slice(0,30)}</option>)\r\n\r\n    return(\r\n      <div>\r\n        <p>Select the 2 layers you want to difference.</p>\r\n        <select id=\"difference_select_geojson1\">\r\n          {listItems}\r\n        </select>\r\n        <select id=\"difference_select_geojson2\">\r\n          {listItems}\r\n        </select>\r\n        <button onClick={(param) => this.executeDifference(param)}>Apply</button>\r\n      </div>\r\n    )\r\n}\r\n\r\n    // Sends call to Sidebar to run Intersect.\r\n    executeDifference(){\r\n      // Collects chosen layers from select list.\r\n      var difference_select1 = document.getElementById(\"difference_select_geojson1\");\r\n      var geojson1 = difference_select1.options[difference_select1.selectedIndex].value;\r\n      var difference_select2 = document.getElementById(\"difference_select_geojson2\");\r\n      var geojson2 = difference_select2.options[difference_select2.selectedIndex].value;\r\n      callDifference(geojson1, geojson2)\r\n    }\r\n\r\n\r\n}\r\n\r\nexport default Difference;\r\n","import React, { Component } from 'react';\r\nimport Sortable from 'sortablejs';\r\nimport './Layers.css';\r\nimport { new_geojsonToParent, getLayerList, deleteLayerCall, geojsonMultiPolygonToPolygon } from './Sidebar.js'\r\nimport { reorderLayers } from '../Map/MainMap'\r\nimport { getLayerListUnion } from './tools/Union.js'\r\nimport { getLayerListIntersect } from './tools/Intersect.js'\r\nimport { getLayerListDifference } from './tools/Difference.js'\r\nimport $ from \"jquery\";\r\nimport FileSaver from 'file-saver';\r\nimport ColorPicker from 'rc-color-picker';\r\nimport 'rc-color-picker/assets/index.css';\r\nvar turf = require('@turf/turf')\r\n\r\n\r\n// Class that handles layer logic and uploading of files.\r\nclass Layers extends Component{\r\n  constructor(props){\r\n    super(props)\r\n    this.state = {\r\n      layer_list: [],\r\n      selected_layer: null,\r\n    }\r\n    this.readGeoJSONFile = this.readGeoJSONFile.bind(this);\r\n    download = download.bind(this)\r\n    createLayer = createLayer.bind(this);\r\n    changeName = changeName.bind(this);\r\n    updateSelected = updateSelected.bind(this);\r\n    this.disableInvalidButtons = this.disableInvalidButtons.bind(this);\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    this.disableInvalidButtons()\r\n    // Appending new file name to Layer list with a unique key value.\r\n    if (this.state.layer_list !== prevState.layer_list ){\r\n      getLayerList(this.state.layer_list)\r\n      getLayerListUnion(this.state.layer_list)\r\n      getLayerListIntersect(this.state.layer_list)\r\n      getLayerListDifference(this.state.layer_list)\r\n\r\n      // Sets a click listener for the newest layer's checkbox event.\r\n      var id = this.state.layer_list[this.state.layer_list.length-1][1];\r\n      var hide_map_element = document.getElementById('checkbox_'+id);\r\n      var edit_layer_element = document.getElementById('customize_'+id);\r\n\r\n      // Adding hide/show when clicking checkbox on layer.\r\n      hide_map_element.addEventListener('click', function(event) {\r\n        // adding stopPropagation so layer is not selected when checkbox is clicked.\r\n        event.stopPropagation();\r\n        // To check whether the checkbox is clicked or not.\r\n        var hide_map_element = document.getElementById('checkbox_'+id);\r\n        // To get the correct layer on the map to hide.\r\n        var map_element = document.getElementsByClassName(\"map-path \"+id);\r\n\r\n        if (hide_map_element.checked == true) {\r\n          $(map_element).show();\r\n        } else {\r\n          $(map_element).hide();\r\n        }\r\n      });\r\n\r\n      edit_layer_element.addEventListener('click', function(event) {\r\n        // adding stopPropagation so layer is not selected when checkbox is clicked.\r\n        event.stopPropagation();\r\n        // To check whether the checkbox is clicked or not.\r\n        var edit_layer_element = document.getElementById('customize_'+id);\r\n        var hide_status = 'customizeDiv_'+id\r\n        var value = $('.'+hide_status).is(\":visible\");\r\n        var list_element = document.getElementsByClassName(\"layer \"+id);\r\n\r\n        if (value) {\r\n          $('.'+hide_status).hide();\r\n          $(list_element).css(\"height\", \"65px\");\r\n        } else {\r\n          $('.'+hide_status).show();\r\n          $(list_element).css(\"height\", \"200px\");\r\n\r\n        }\r\n      });\r\n\r\n    }\r\n\r\n    // Make all the new layers selectable and dragable.\r\n    addLayerProperties()\r\n\r\n\r\n  }\r\n\r\n  componentDidMount() {\r\n    // Make the initial layers selectable and dragable.\r\n    addLayerProperties()\r\n    this.disableInvalidButtons()\r\n\r\n  }\r\n\r\n  render(){\r\n    // Parses through all layers stored in memory and add them to the Layer list.\r\n    const layer_data_list = this.state.layer_list\r\n    var data = []\r\n    for (var i = 0; i < layer_data_list.length; i++) {\r\n      data.push({\"name\":layer_data_list[i][0],\"key\":layer_data_list[i][1]})\r\n    }\r\n    const listItems = data.map((d) =>\r\n      <li className={\"layer \"+d.key} id={d.key}>\r\n        <div className=\"LayerContainer\">\r\n          <div className=\"LayerData\">\r\n            <p className=\"LayerName dont-break-out\" id={\"name_\"+d.key}>\r\n              {d.name.slice(0,30)}\r\n            </p>\r\n            <input className=\"toggleShow\" type=\"checkbox\" defaultChecked={true} id={\"checkbox_\"+d.key} />\r\n            <input className=\"customize\" type=\"button\" value=\"⚙️\" id={\"customize_\"+d.key} />\r\n\r\n          </div>\r\n          <div className={\"customizeDiv_\"+d.key} hidden >\r\n            <div>\r\n              <p id={\"edit_text\"}>Change name:</p>\r\n              <input type=\"text\" value={d.name} onChange={(param) => changeName(d.key)} id={\"change_name_\"+d.key} />\r\n              <p id={\"edit_text\"}>Change colors:</p>\r\n              <div id=\"container\">\r\n                <div id=\"fill\">\r\n                  <p>Fill</p><ColorPicker className={d.key} color={'#0ad'} onChange={customizeFill} alpha={50}/>\r\n                </div>\r\n                <div id=\"stroke\">\r\n                  <p>Stroke</p><ColorPicker className={d.key} color={'#0ad'} onChange={customizeStroke} alpha={50}/>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </li>\r\n    )\r\n\r\n    return(\r\n      <div id=\"layers\">\r\n        <p id=\"subtitle\">Layers</p>\r\n        <button id=\"delete\" onClick={(param) => this.deleteLayer(param)}>🗑️</button>\r\n        <button id=\"save\" onClick={(param) => download(param)}>💾</button>\r\n        <p id='sub_info'>Click to select, drag to reorder.</p>\r\n        <div>\r\n          <ul id=\"sortable_layers\" className=\"ui-sortable\">\r\n            {listItems}\r\n          </ul>\r\n        </div>\r\n        <div>\r\n          <p id=\"subtitle\">Add Layer</p>\r\n          <div>\r\n            {/* Hidden input field to handle file upload on button click. */}\r\n            <input id='fileid' type='file' onChange={(param) => this.readGeoJSONFile(param)} accept=\".GeoJSON,.JSON\" hidden/>\r\n            <button id=\"upload\" onClick={(param) => this.activateFileUpload(param)}>Upload file</button>\r\n          </div>\r\n          <p id='sub_info'>Click button and upload GeoJSON or JSON file.</p>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n  // Makes buttons unclickable if no layer is selected.\r\n  disableInvalidButtons() {\r\n    if (this.state.selected_layer == null) {\r\n       $('#delete').prop('disabled', true);\r\n       $('#delete').css( 'cursor', 'not-allowed' );\r\n       $('#save').prop('disabled', true);\r\n       $('#save').css( 'cursor', 'not-allowed' );\r\n\r\n    } else {\r\n      $('#delete').prop('disabled', false);\r\n      $('#delete').css( 'cursor', 'pointer' );\r\n      $('#save').prop('disabled', false);\r\n      $('#save').css( 'cursor', 'pointer' );\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Checks if upload GeoJSON button has been clicked, and file has been selected.\r\n  activateFileUpload(){\r\n    document.getElementById('fileid').click();\r\n  }\r\n\r\n  // Sends call to Sidebar to delete selected layer, when delete button is clicked.\r\n  deleteLayer(){\r\n    var delete_layer_key= ($('li.active').attr('id'));\r\n    deleteLayerCall(delete_layer_key)\r\n    this.setState({\r\n      selected_layer: null\r\n    })\r\n\r\n  }\r\n\r\n  // Adding file reading code in Layers as this is the only place it is used.\r\n  readGeoJSONFile(file_upload){\r\n    //Retrieving the first (and only!) File from the FileList object\r\n    var file = file_upload.target.files[0];\r\n    const newest_file_key = Math.random().toString(36).substr(2, 9);\r\n    //NOTE: Math.random should be unique (with less than 10.000 simulatanious layers) because of its seeding algorithm.\r\n    const newest_file_name = file.name;\r\n\r\n    if (file) {\r\n      var reader = new FileReader();\r\n      reader.onload = function(e) {\r\n        const new_geojson = JSON.parse(e.target.result)\r\n\r\n        // Checks the uploaded file, and cleans the data, making everything on same format.\r\n        if (new_geojson.type == 'FeatureCollection') {\r\n          var geojson_features = new_geojson.features\r\n          var new_features = []\r\n\r\n          for (var i = 0; i < geojson_features.length; i++) {\r\n            if(geojson_features[i].geometry.type == 'Polygon') {\r\n              new_features.push(geojson_features[i])\r\n            }\r\n            else if(geojson_features[i].geometry.type == 'MultiPolygon') {\r\n              for (var j = 0; j < geojson_features[i].geometry.coordinates.length; j++) {\r\n                var feature = {\"type\": \"Feature\", \"properties\": {},  \"geometry\": { \"type\": \"Polygon\", \"coordinates\": geojson_features[i].geometry.coordinates[j] }}\r\n                feature.properties = geojson_features[i].properties\r\n                new_features.push(feature)\r\n              }\r\n            }\r\n            else if(geojson_features[i].geometry.type == 'Point') {\r\n              var circle = turf.circle(geojson_features[i].geometry.coordinates, 0.0025)\r\n              circle.properties = geojson_features[i].properties\r\n              new_features.push(circle)\r\n            } else if(geojson_features[i].geometry.type == 'LineString') {\r\n              new_features.push(geojson_features[i])\r\n            }\r\n          }\r\n          var clean_geojson = {\"type\":\"FeatureCollection\",\"features\": new_features };\r\n        } else if (new_geojson.type == 'Feature') {\r\n            var clean_geojson = {\"type\":\"FeatureCollection\",\"features\": new_geojson };\r\n        } else {\r\n          var clean_geojson = clean_data(new_geojson)\r\n        }\r\n        // Sending the JSON extracted from file to Parent component.\r\n        new_geojsonToParent(clean_geojson, newest_file_key)\r\n        createLayer(newest_file_name, newest_file_key, clean_geojson)\r\n\r\n\r\n      }\r\n      reader.readAsText(file);\r\n    } else {\r\n      alert(\"Failed to load file\");\r\n    }\r\n\r\n  }\r\n}\r\n\r\n\r\n// Call to change layer name.\r\nexport function changeName(id) {\r\n  var input_element = $('#change_name_'+id).val();\r\n  if (input_element == undefined) {\r\n  } else {\r\n\r\n    for (var i = 0; i < this.state.layer_list.length; i++) {\r\n      if (id == this.state.layer_list[i][1]){\r\n        var position = i\r\n      }\r\n    }\r\n\r\n    var layers = [...this.state.layer_list]\r\n    layers[position][0] = input_element\r\n    this.setState( {layers} )\r\n  }\r\n}\r\n\r\n// Add the customization of Layer fill (inner) to ther map.\r\nfunction customizeFill(colors) {\r\n  var map_element = document.getElementsByClassName(\"map-path \"+this.className);\r\n  $(map_element).css(\"fill\", colors.color);\r\n  $(map_element).css(\"fill-opacity\", colors.alpha/100);\r\n}\r\n\r\n\r\n// Add the customization of Layer stroke (border) to ther map.\r\nfunction customizeStroke(colors) {\r\n  var map_element = document.getElementsByClassName(\"map-path \"+this.className);\r\n  $(map_element).css(\"stroke\", colors.color);\r\n  $(map_element).css(\"stroke-opacity\", colors.alpha/100);\r\n}\r\n\r\n// Function that creates a file for selected layer to download.\r\nexport function download(geojson_key) {\r\n  var download_layer_key= ($('li.active').attr('id'));\r\n  for (var i = 0; i < this.state.layer_list.length; i++) {\r\n    if (download_layer_key == this.state.layer_list[i][1]){\r\n      var layer_position = i\r\n    }\r\n  }\r\n  var geojson_file = this.state.layer_list[layer_position][2]\r\n  var geojson_file_name = this.state.layer_list[layer_position][0]\r\n  var filename = geojson_file_name.split(' ').join('_');\r\n  var filename = filename.replace('.geojson', '');\r\n\r\n  var blob = new Blob([JSON.stringify(geojson_file)], {type: \"geojson;charset=utf-8\"});\r\n  FileSaver.saveAs(blob, filename+\".geojson\");\r\n}\r\n\r\n// Function that takes in all kinds of GeoJSON/JSON map data and cleans it.\r\nexport function clean_data(new_geojson) {\r\n  if (new_geojson.type == 'Polygon') {\r\n    var geojson = {\"type\":\"FeatureCollection\",\"features\":[{\"type\": \"Feature\", \"properties\": {},  \"geometry\": { \"type\": \"Polygon\", \"coordinates\": new_geojson.coordinates }}]};\r\n    return geojson\r\n  } else if (new_geojson.type == 'MultiPolygon') {\r\n      return geojsonMultiPolygonToPolygon(new_geojson)\r\n  } else if (new_geojson.type == 'Point') {\r\n    var circle = turf.circle(new_geojson.coordinates, 2)\r\n    var geojson = {\"type\":\"FeatureCollection\",\"features\": circle };\r\n    return geojson\r\n  }\r\n\r\n}\r\n\r\n\r\n// helper function that collect read data and sets new state.\r\nexport function createLayer(newest_file_name, newest_file_key, new_geojson){\r\n  this.setState({\r\n    layer_list: [...this.state.layer_list, [newest_file_name, newest_file_key, new_geojson]]\r\n  })\r\n}\r\n\r\n// helper function that returns selected layer.\r\nexport function updateSelected(){\r\n  var selected_key= ($('li.active').attr('id'));\r\n  for (var i = 0; i < this.state.layer_list.length; i++) {\r\n    if (selected_key == this.state.layer_list[i][1]){\r\n      var layer_position = i\r\n    }\r\n  }\r\n  var geojson_file_name = this.state.layer_list[layer_position][0]\r\n  this.setState({\r\n    selected_layer: geojson_file_name\r\n  })\r\n}\r\n\r\n// Adds sortable and selectable options to layers.\r\nfunction addLayerProperties() {\r\n  // Gets the class name for the layer list.\r\n  var layer_list = document.getElementById(\"sortable_layers\");\r\n\r\n  // Makes the sidebar layer list selectable.\r\n  var layer = layer_list.getElementsByClassName(\"layer\");\r\n  for (var i = 0; i < layer.length; i++) {\r\n      layer[i].addEventListener(\"click\", function() {\r\n          var current = document.getElementsByClassName(\"active\");\r\n          if (current[0]){\r\n          current[0].className = current[0].className.replace(\" active\", \"\");\r\n          }\r\n          this.className += \" active\";\r\n          updateSelected()\r\n\r\n      });\r\n  }\r\n\r\n  reorderLayers(getLayers())\r\n\r\n\r\n\r\n  // Makes the sidebar layer list sortable\r\n  Sortable.create(layer_list,{\r\n      onEnd: function (e){\r\n          // Reorders the layers based on ID name ordering.\r\n          reorderLayers(getLayers())\r\n      }\r\n  })\r\n\r\n  // Function that returns all layers (and their order.)\r\nfunction getLayers(){\r\n  var i;\r\n  var list_order = [];\r\n  var a = document.getElementsByClassName(\"layer\")\r\n  for (i=0; i < a.length; i++){\r\n      var class_name = ((a[i].className).split(\" \"))\r\n      list_order.push(class_name[1])\r\n  }\r\n  return list_order;\r\n}\r\n\r\n}\r\n\r\nexport default Layers;\r\n","import React, { Component } from 'react';\r\nimport \"./Buffer.css\"\r\nimport MainMap from '../../Map/MainMap'\r\nimport L from 'leaflet'\r\nimport { callBuffer } from '../Sidebar.js'\r\nimport $ from \"jquery\";\r\n\r\n\r\n\r\nclass Buffer extends Component{\r\n  constructor(props) {\r\n    super(props)\r\n  }\r\n    render(){\r\n        return(\r\n        <div>\r\n            <p>Select layer by clicking on it.</p>\r\n            <div id=\"tool_title\">Distance: [meters]</div>\r\n            <input id=\"buffer_number\" type=\"number\" placeholder=\"Buffer in meters\"></input>\r\n            <br></br>\r\n            <button onClick={(param) => this.executeBuffer(param)}>Apply</button>\r\n        </div>\r\n        )\r\n    }\r\n\r\n    // Sends call to Sidebar to run Buffer code.\r\n    executeBuffer(){\r\n      var buffer_radius = document.getElementById('buffer_number').value;\r\n      var layer_key= ($('li.active').attr('id'));\r\n      callBuffer(buffer_radius, layer_key)\r\n    }\r\n}\r\n\r\n\r\n\r\nexport default Buffer;\r\n","import React, { Component } from 'react';\r\nimport \"./Dissolve.css\"\r\nimport { callDissolve } from '../Sidebar.js'\r\nimport $ from \"jquery\";\r\n\r\n\r\nclass Dissolve extends Component{\r\n    render(){\r\n        return(\r\n        <div>\r\n          <p>Select layer by clicking on it.</p>\r\n          <button onClick={(param) => this.executeDissolve(param)}>Apply</button>\r\n        </div>\r\n        )\r\n    }\r\n\r\n    // Sends call to Sidebar to run Dissolve code.\r\n    executeDissolve(){\r\n      var layer_key= ($('li.active').attr('id'));\r\n      callDissolve(layer_key)\r\n    }\r\n}\r\n\r\nexport default Dissolve;\r\n","import React, { Component } from 'react';\r\nimport \"./Extract_Feature.css\"\r\nimport MainMap from '../../Map/MainMap'\r\nimport L from 'leaflet'\r\nimport { getProperties } from '../Sidebar.js'\r\nimport $ from \"jquery\";\r\n\r\n\r\nclass Extract_Feature extends Component{\r\n  constructor(props) {\r\n    super(props)\r\n  }\r\n\r\n  render(){\r\n\r\n  return(\r\n    <div>\r\n      <p>Select layer by clicking on it and click \"Open Extract\"</p>\r\n      <button onClick={(param) => this.executeExtract(param)}>Open Extract</button>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\n    // Sends call to Sidebar to run Extract code.\r\n    executeExtract(){\r\n      var layer_key= ($('li.active').attr('id'));\r\n      var extract_options = document.getElementById(\"extract_feature_window\")\r\n      $(extract_options).show();\r\n      getProperties(layer_key)\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\nexport default Extract_Feature;\r\n","import React, { Component } from 'react';\r\nimport \"./ExtractFeatureWindow.css\"\r\nimport $ from \"jquery\";\r\n\r\n\r\n// Fetches properties from layers, in order to get selected data.\r\nexport function getPropertiesList(properties_list, layerName) {\r\n  this.setState({ properties_list, layerName })\r\n}\r\n\r\n\r\nclass ExtractFeatureWindow extends Component{\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      properties_list: [],\r\n      layerName: null,\r\n      rules: [],\r\n\r\n    }\r\n    getPropertiesList = getPropertiesList.bind(this)\r\n    this.collectAddData = this.collectAddData.bind(this)\r\n  }\r\n    render(){\r\n\r\n        const layer_data_list = this.state.properties_list\r\n        var properties = \"\"\r\n        for (var i = 0; i < layer_data_list.length; i++) {\r\n         properties += \"<option value='\"+ layer_data_list[i][0] +\"'>\"+ layer_data_list[i][0] +\"</option>\"\r\n        }\r\n        $( \"#propertySelect\" ).append(properties);\r\n\r\n        return(\r\n        <div className=\"Extract_window\">\r\n            <p>Extracting features from {this.state.layerName} </p>\r\n            New Layer name: <input className=\"extract_name\" type=\"text\"/>\r\n            <button onClick={(param) => this.toggleAddRulePanel(param)}>Add Rule</button>\r\n            <button onClick={(param) => this.executeExtract(param)}>Extract</button>\r\n            <button onClick={(param) => this.closeWindow(param)}>Close Window</button>\r\n            <div>\r\n            </div>\r\n            <div id=\"addRulePanel\" hidden>\r\n              <select id=\"propertySelect\">\r\n              </select>\r\n              <select id=\"symbolSelect\">\r\n                <option value='=='>Equals</option>\r\n                <option value='!='>Not Equal to</option>\r\n                <option value='<'>Above</option>\r\n                <option value='>'>Below</option>\r\n                <option value='<='>Equals or above</option>\r\n                <option value='>='>Equals or below</option>\r\n              </select>\r\n              <input id=\"value_input\" type=\"text\"/>\r\n              <button onClick={(param) => this.collectAddData(param)}>Add</button>\r\n\r\n            </div>\r\n\r\n        </div>\r\n\r\n        )\r\n    }\r\n\r\n    collectAddData(){\r\n      var value = document.getElementById('value_input').value\r\n      var property = document.getElementById('propertySelect').value\r\n      var symbol = document.getElementById('symbolSelect').value\r\n      var rule = [property, symbol, value]\r\n      $('#addRulePanel').hide();\r\n\r\n\r\n      this.setState(prevState => ({\r\n        rules: [...prevState.rules, rule]\r\n      }))\r\n\r\n\r\n    }\r\n\r\n    closeWindow() {\r\n      var extract_options = document.getElementById(\"extract_feature_window\")\r\n      var layerName = null;\r\n      $(extract_options).hide();\r\n      this.setState({ layerName })\r\n      $('#addRulePanel').hide();\r\n\r\n      // TODO Slett alle eksisterende \"rules\"\r\n    }\r\n\r\n    toggleAddRulePanel() {\r\n      var value = $('#addRulePanel').is(\":visible\");\r\n      if (value) {\r\n        $('#addRulePanel').hide();\r\n      } else {\r\n        $('#addRulePanel').show();\r\n      }\r\n    }\r\n\r\n    executeExtract() {\r\n      console.log(\"EXTRACT\")\r\n\r\n    }\r\n}\r\n\r\n\r\n\r\nexport default ExtractFeatureWindow;\r\n","import React, { Component } from 'react';\r\nimport Layers from \"./Layers\";\r\nimport \"./Sidebar.css\";\r\nimport Buffer from './tools/Buffer';\r\nimport Dissolve from './tools/Dissolve';\r\nimport Union from './tools/Union';\r\nimport Intersect from './tools/Intersect';\r\nimport Difference from './tools/Difference';\r\nimport Extract_Feature from './tools/Extract_Feature'\r\nimport { getPropertiesList } from './ExtractFeatureWindow'\r\nimport { get_newgeojson } from '../Map/MainMap'\r\nimport { createLayer } from './Layers'\r\nimport $ from \"jquery\";\r\nimport L from 'leaflet';\r\nvar turf = require('@turf/turf')\r\n\r\n// Gets call from Buffer and sends data to MainMap and Layer\r\nexport function callBuffer(buffer_radius, geojson_file_key) {\r\n  var layer_position = find_called_geojson(geojson_file_key)\r\n  var selected_layer_geojson = collect_called_geojson(layer_position)\r\n  var selected_layer_name = this.state.layer_list[layer_position][0]\r\n  var buffered = turf.buffer(selected_layer_geojson, buffer_radius, {units: 'meters'});\r\n\r\n  // Runs dissolve on the buffer, so we don't get overlapping buffer zones.\r\n  var buffer_dissolved = buffered.features[0]\r\n  for (var i = 1; i < buffered.features.length; i++) {\r\n    buffer_dissolved = turf.union(buffer_dissolved, buffered.features[i])\r\n  }\r\n\r\n  // Cleans the returned dissolve data.\r\n  if (buffer_dissolved.geometry.type == 'MultiPolygon') {\r\n    var multipolygon = {\"type\":\"FeatureCollection\",\"features\": [buffer_dissolved]};\r\n    final_buffer = geojsonMultiPolygonToPolygon(multipolygon)\r\n  } else {\r\n    var final_buffer = {\"type\":\"FeatureCollection\",\"features\": [buffer_dissolved]};\r\n  }\r\n\r\n  const buffer_layer_key = generateKey()\r\n  get_newgeojson(final_buffer, buffer_layer_key)\r\n  createLayer(selected_layer_name+' '+buffer_radius+' m buffer', buffer_layer_key, final_buffer)\r\n}\r\n\r\n// Gets call from Dissolve and sends data to MainMap and Layer\r\nexport function callDissolve(geojson_file_key) {\r\n  /* The Turf.JS code for dissolve is not working as intended (said by author).\r\n  Therefore we use union instead, on all polygons within geojson file. */\r\n  var layer_position = find_called_geojson(geojson_file_key)\r\n  var selected_layer_geojson = collect_called_geojson(layer_position)\r\n  var selected_layer_name = this.state.layer_list[layer_position][0]\r\n\r\n  var dissolveLayer = selected_layer_geojson.features[0]\r\n\r\n  for (var i = 1; i < selected_layer_geojson.features.length; i++) {\r\n    dissolveLayer = turf.union(dissolveLayer, selected_layer_geojson.features[i])\r\n  }\r\n\r\n  // Cleans the returned dissolve data.\r\n  if (dissolveLayer.geometry.type == 'MultiPolygon') {\r\n    var multipolygon = {\"type\":\"FeatureCollection\",\"features\": [dissolveLayer]};\r\n    final_dissolve = geojsonMultiPolygonToPolygon(multipolygon)\r\n  } else {\r\n    var final_dissolve = {\"type\":\"FeatureCollection\",\"features\": [dissolveLayer]};\r\n  }\r\n\r\n  const dissolve_layer_key = generateKey()\r\n  get_newgeojson(final_dissolve, dissolve_layer_key)\r\n  createLayer(selected_layer_name+' dissolved', dissolve_layer_key, final_dissolve)\r\n}\r\n\r\n// Gets call from Union and sends data to MainMap and Layer\r\nexport function callUnion(geojson_file_key1, geojson_file_key2) {\r\n  /*NOTE:  As the union function uses polygons not geojson files as input,\r\n  we need to seperate the geojson files into features and merge all of them. */\r\n\r\n  // gets the data for the first geojson file stored in memory.\r\n  var layer_position1 = find_called_geojson(geojson_file_key1)\r\n  var selected_layer_geojson1 = collect_called_geojson(layer_position1)\r\n  var selected_layer_name1 = this.state.layer_list[layer_position1][0]\r\n  // gets the data for the second geojson file stored in memory.\r\n  var layer_position2 = find_called_geojson(geojson_file_key2)\r\n  var selected_layer_geojson2 = collect_called_geojson(layer_position2)\r\n  var selected_layer_name2 = this.state.layer_list[layer_position2][0]\r\n\r\n  // combines the geojson files into one, in case we have mulitple features in one of them.\r\n  var unionLayer = {\r\n    \"type\" : \"FeatureCollection\",\r\n    \"features\": [...selected_layer_geojson1.features, ...selected_layer_geojson2.features]\r\n  }\r\n\r\n  const union_layer_key = generateKey()\r\n  get_newgeojson(unionLayer, union_layer_key)\r\n  createLayer('union '+selected_layer_name1+' & '+selected_layer_name2, union_layer_key, unionLayer)\r\n\r\n}\r\n\r\nexport function callIntersect(geojson_file_key1, geojson_file_key2) {\r\n  /*NOTE: Intersect also uses features, so we need to do a similar combination as with union. */\r\n\r\n  // gets the data for the first geojson file stored in memory.\r\n  var layer_position1 = find_called_geojson(geojson_file_key1)\r\n  var selected_layer_geojson1 = collect_called_geojson(layer_position1)\r\n  var selected_layer_name1 = this.state.layer_list[layer_position1][0]\r\n  // gets the data for the second geojson file stored in memory.\r\n  var layer_position2 = find_called_geojson(geojson_file_key2)\r\n  var selected_layer_geojson2 = collect_called_geojson(layer_position2)\r\n  var selected_layer_name2 = this.state.layer_list[layer_position2][0]\r\n\r\n  // Make a list of all the features in both Geojson files.\r\n  var f1 = selected_layer_geojson1.features\r\n  var f2 = selected_layer_geojson2.features\r\n\r\n\r\n  var conflictlist = [];\r\n\r\n  for (var i = 0; i < f1.length; i++) {\r\n      var parcel1 = f1[i];\r\n\r\n      for (var j = 0; j <f2.length; j++) {\r\n\r\n          var parcel2 = f2[j];\r\n\r\n              var conflict = turf.intersect(parcel1, parcel2);\r\n              if (conflict != null) {\r\n                  conflictlist.push(conflict);\r\n              }\r\n      }\r\n  }\r\n\r\n  var lg = new L.LayerGroup();\r\n  var intersectLayer = {\"type\":\"FeatureCollection\",\"features\": conflictlist};\r\n\r\n  const intersect_layer_key = generateKey()\r\n  get_newgeojson(intersectLayer, intersect_layer_key)\r\n  createLayer('intersect '+selected_layer_name1+' & '+selected_layer_name2, intersect_layer_key, intersectLayer)\r\n}\r\n\r\nexport function callDifference(geojson_file_key1, geojson_file_key2) {\r\n  /*NOTE: Difference also uses features (single Polygon or MultiPolygon), so we need to make sure all features are either a singe polygon\r\n    or a geojson file with a MultiPolygon geometry type.*/\r\n\r\n  // gets the data for the first geojson file stored in memory.\r\n  var layer_position1 = find_called_geojson(geojson_file_key1)\r\n  var selected_layer_geojson1 = collect_called_geojson(layer_position1)\r\n  var selected_layer_name1 = this.state.layer_list[layer_position1][0]\r\n  // gets the data for the second geojson file stored in memory.\r\n  var layer_position2 = find_called_geojson(geojson_file_key2)\r\n  var selected_layer_geojson2 = collect_called_geojson(layer_position2)\r\n  var selected_layer_name2 = this.state.layer_list[layer_position2][0]\r\n\r\n  // Takes the selected geojson files and converts them to MultiPolygon geometry.\r\n  var difference1 = geojsonPolygonToMultiPolygon(selected_layer_geojson1)\r\n  var difference2 = geojsonPolygonToMultiPolygon(selected_layer_geojson2)\r\n\r\n  // Runs the difference algorithm on the two multipolygon files.\r\n  var difference = turf.difference(difference1.features[0], difference2.features[0])\r\n\r\n\r\n  // Merges the difference layer into a new geojson file.\r\n  if (difference == null) {\r\n    difference = null\r\n  } else {\r\n    var differenceLayer_multipolygon = {\"type\":\"FeatureCollection\",\"features\": [difference]};\r\n    var differenceLayer = geojsonMultiPolygonToPolygon(differenceLayer_multipolygon)\r\n  }\r\n\r\n\r\n  const difference_layer_key = generateKey()\r\n  get_newgeojson(differenceLayer, difference_layer_key)\r\n  createLayer(selected_layer_name1+' - '+selected_layer_name2, difference_layer_key, differenceLayer)\r\n\r\n}\r\n\r\n// Getting the properties for selected GeoJSON file.\r\nexport function getProperties(geojson_file_key) {\r\n  // gets the data for the geojson file stored in memory.\r\n  var layer_position = find_called_geojson(geojson_file_key)\r\n  var selected_layer_geojson = collect_called_geojson(layer_position)\r\n  var selected_layer_name = this.state.layer_list[layer_position][0]\r\n\r\n  var properties = []\r\n  var valuearray = []\r\n  // Getting all unique properties and their values.\r\n  for (var i = 0; i < selected_layer_geojson.features.length; i++ ){\r\n    for (var property in selected_layer_geojson.features[i].properties){\r\n      if(selected_layer_geojson.features[i].properties.hasOwnProperty(property)) {\r\n       var value = selected_layer_geojson.features[i].properties[property]\r\n      }\r\n      if(properties.indexOf(property) === -1) {\r\n        properties.push(property)\r\n        valuearray.push([value])\r\n      } else {\r\n        if(valuearray[properties.indexOf(property)].indexOf(value) === -1){\r\n          valuearray[properties.indexOf(property)].push(value)\r\n        }\r\n      }\r\n    }\r\n  }\r\n  // Combining the arrays, so we get data sorted in a neat matter.\r\n  var property_data = []\r\n  for (var i = 0; i < properties.length; i++ ){\r\n    property_data.push([properties[i], valuearray[i]])\r\n  }\r\n\r\n  getPropertiesList(property_data, selected_layer_name)\r\n}\r\n\r\n// Converts a geojson consisting with mulitple polygons into a geojson file with MultiPolygon geometry for difference function.\r\nexport function geojsonPolygonToMultiPolygon(geojson) {\r\n  var geojson_features = geojson.features\r\n\r\n  var coordinates = []\r\n\r\n  for (var i = 0; i < geojson_features.length; i++) {\r\n      if(geojson_features[i].geometry.type == 'Polygon') {\r\n        coordinates.push(geojson_features[i].geometry.coordinates)\r\n      } else if(geojson_features[i].geometry.type == 'LineString') {\r\n        var feature = turf.buffer(geojson_features[i].geometry, 0.5)\r\n        coordinates.push(feature.geometry.coordinates)\r\n      } else if (geojson_features[i].geometry.type == 'MultiPolygon'){\r\n        coordinates.push(geojson_features[i].geometry.coordinates)\r\n      } else if(geojson_features[i].geometry.type == 'Point') {\r\n        var feature = turf.buffer(geojson_features[i].geometry, 0.5)\r\n        coordinates.push(feature.geometry.coordinates)\r\n      }\r\n  }\r\n  var new_geojson = {\"type\":\"FeatureCollection\",\"features\":[{\"type\": \"Feature\", \"properties\": {},  \"geometry\": { \"type\": \"MultiPolygon\", \"coordinates\": coordinates }}]};\r\n  return new_geojson\r\n}\r\n\r\n/* Converts a geojson consisting of MultiPolygon to  a geojson file separate Polygons.\r\nNote: This function exists to revert geojson files back to single polygons, in order to:\r\na) Keep the data consistent. b) Single polygons are required for some functions (e.g Dissolve) */\r\nexport function geojsonMultiPolygonToPolygon(geojson) {\r\n  var geojson_features = geojson.features\r\n\r\n  var new_features = []\r\n  for (var i = 0; i < geojson_features.length; i++) {\r\n    if(geojson_features[i].geometry.type == 'Polygon') {\r\n      new_features.push(geojson_features[i])\r\n    } else if(geojson_features[i].geometry.type == 'MultiPolygon') {\r\n      for (var j = 0; j < geojson_features[i].geometry.coordinates.length; j++) {\r\n        var feature = {\"type\": \"Feature\", \"properties\": {},  \"geometry\": { \"type\": \"Polygon\", \"coordinates\": geojson_features[i].geometry.coordinates[j] }}\r\n        new_features.push(feature)\r\n      }\r\n    }\r\n  }\r\n  var new_geojson = {\"type\":\"FeatureCollection\",\"features\": new_features };\r\n  return new_geojson\r\n\r\n}\r\n\r\nexport function deleteLayerCall(geojson_file_key) {\r\n  var layer_position = find_called_geojson(geojson_file_key)\r\n  var selected_layer_geojson = this.state.layer_list[layer_position][2]\r\n  // Removes the layer for the selected geojson file in sidebar and in the selection part of the Tools.\r\n  $( \"#\"+geojson_file_key+\"\" ).remove();\r\n  $( \"#layer_\"+geojson_file_key+\"\" ).remove();\r\n\r\n  // Removes the geojson layers from the map.\r\n  $( \".\"+geojson_file_key+\"\" ).remove();\r\n\r\n  // TODO: Remove layer from UNION\r\n}\r\n\r\n// Finds position in layer list for geojson based on key value.\r\nfunction find_called_geojson(geojson_file_key){\r\n  for (var i = 0; i < this.state.layer_list.length; i++) {\r\n    if (geojson_file_key == this.state.layer_list[i][1]){\r\n      return i\r\n    }\r\n  }\r\n}\r\n\r\n// Returns the geojson file, in a format suited for the operations.\r\nexport function collect_called_geojson(geojson_file_position){\r\n  var geojson_file = this.state.layer_list[geojson_file_position][2]\r\n  // If file is a FeatureCollection, we can simply return it.\r\n  return geojson_file\r\n\r\n\r\n}\r\n\r\n// Generate new layer layer key\r\nfunction generateKey() {\r\n  return Math.random().toString(36).substr(2, 9);\r\n}\r\n\r\n// Fetches GeoJSON properties from Layer and passes them on to MainMap.\r\nexport function new_geojsonToParent(new_geojson, newest_file_key) {\r\n  get_newgeojson(new_geojson, newest_file_key)\r\n}\r\n\r\n// Function that takes in all kinds of GeoJSON/JSON map data and cleans it.\r\nexport function clean_data(new_geojson) {\r\n  if (new_geojson.type == 'Polygon') {\r\n    var geojson = {\"type\":\"FeatureCollection\",\"features\":[{\"type\": \"Feature\", \"properties\": {},  \"geometry\": { \"type\": \"Polygon\", \"coordinates\": new_geojson.coordinates }}]};\r\n    return geojson\r\n  } else if (new_geojson.type == 'MultiPolygon') {\r\n      return geojsonMultiPolygonToPolygon(new_geojson)\r\n  } else if (new_geojson.type == 'Point') {\r\n    var circle = turf.circle(new_geojson.coordinates, 2)\r\n    var geojson = {\"type\":\"FeatureCollection\",\"features\": circle };\r\n    return geojson\r\n  }\r\n\r\n}\r\n\r\n// Fetches layer_list from layers, in order to send geojson data to MainMap.\r\nexport function getLayerList(layer_list) {\r\n  this.setState({ layer_list })\r\n}\r\n\r\nclass Sidebar extends Component {\r\n  constructor(props){\r\n    super(props)\r\n    this.state = {\r\n      layer_list: []\r\n    }\r\n    callBuffer = callBuffer.bind(this)\r\n    callDissolve = callDissolve.bind(this)\r\n    callUnion = callUnion.bind(this)\r\n    callIntersect = callIntersect.bind(this)\r\n    callDifference = callDifference.bind(this)\r\n    getProperties = getProperties.bind(this)\r\n    new_geojsonToParent = new_geojsonToParent.bind(this)\r\n    getLayerList = getLayerList.bind(this)\r\n    find_called_geojson = find_called_geojson.bind(this)\r\n    deleteLayerCall = deleteLayerCall.bind(this)\r\n    collect_called_geojson = collect_called_geojson.bind(this)\r\n\r\n  }\r\n\r\n  render() {\r\n    return ([\r\n      <div id=\"sidebar_content\">\r\n          <div id=\"sidebar_title_div\">\r\n              <a href=\"http://www.anstra.no/\" target=\"_blank\" id=\"title\">StrandGIS</a>\r\n          </div>\r\n          <div id=\"tools\">\r\n              <p id=\"subtitle\">Tools</p>\r\n              <ul id=\"tool_layer\">\r\n                  <li className=\"buffer\">\r\n                      Buffer {this.state.buffer_radius}\r\n                  </li>\r\n                  <li hidden className=\"buffer_content\"><Buffer/></li>\r\n                  <li className=\"dissolve\">\r\n                      Dissolve\r\n                  </li>\r\n                  <li hidden className=\"dissolve_content\"><Dissolve/></li>\r\n                  <li className=\"union\">\r\n                      Union\r\n                  </li>\r\n                  <li hidden className=\"union_content\"><Union/></li>\r\n                  <li className=\"intersect\">\r\n                      Intersect\r\n                  </li>\r\n                  <li hidden className=\"intersect_content\"><Intersect/></li>\r\n                  <li className=\"difference\">\r\n                      Difference\r\n                  </li>\r\n                  <li hidden className=\"difference_content\"><Difference/></li>\r\n                  <li className=\"extract\">\r\n                      Extract Feature\r\n                  </li>\r\n                  <li hidden className=\"extract_content\"><Extract_Feature/></li>\r\n              </ul>\r\n          </div>\r\n          <div id='Layers'>\r\n              <Layers/>\r\n          </div>\r\n      </div>\r\n    ])\r\n  }\r\n}\r\n\r\nexport default Sidebar;\r\n","import React, { Component } from 'react';\r\nimport MainMap from \"./Map/MainMap\"\r\nimport Sidebar from \"./sidebar/Sidebar\"\r\nimport ExtractFeatureWindow from './sidebar/ExtractFeatureWindow'\r\nimport \"./App.css\"\r\n\r\nclass App extends Component {\r\n    render() {\r\n        return ([\r\n          <div id='page_content'>\r\n            <div id='map_window'>\r\n              <div id='extract_feature_window' hidden>\r\n                <ExtractFeatureWindow key='extract_feature_window_key'/>\r\n              </div>\r\n              <MainMap key='mainmap_key'/>\r\n            </div>\r\n            <div id='sidebar'>\r\n              <Sidebar key='sidebar_key'/>\r\n            </div>\r\n          </div>\r\n        ])\r\n      }\r\n}\r\n\r\nexport default App;\r\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'leaflet/dist/leaflet.css';\nimport './index.css';\nimport App from './App';\nimport registerServiceWorker from './registerServiceWorker';\nimport $ from \"jquery\";\n\n\nReactDOM.render(<App />, document.getElementById('root'));\nregisterServiceWorker();\n\n\n\n$( '.buffer' ).click(function() {\n    $('.buffer_content').toggle();\n});\n\n$( '.dissolve' ).click(function() {\n    $('.dissolve_content').toggle();\n});\n\n$( '.intersection' ).click(function() {\n   console.log(\"Intersect\")\n});\n\n$( '.union' ).click(function() {\n  $('.union_content').toggle();\n});\n\n$( '.intersect' ).click(function() {\n  $('.intersect_content').toggle();\n});\n\n$( '.difference' ).click(function() {\n  $('.difference_content').toggle();\n});\n\n$( '.extract' ).click(function() {\n  $('.extract_content').toggle();\n});\n"],"sourceRoot":""}